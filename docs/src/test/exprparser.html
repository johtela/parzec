
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>
            parzec - Parsing Arithmetic Epressions
        </title>
        <link rel="icon" type="image/icon" href="../../images/favicon.svg" />
        <link rel="stylesheet" href="../../dist/normal.css" />
        
    </head>
    <body data-syntax-highlight="monokai"
        data-theme="purple-rain">
        
        <div id="navbar">
            
    <div class="navmenu ">
        
    <div class="navitem " >
        <a class="title enabled" href="../../index.html" >
            <img src="../../images/millenniumfalcon_88882.svg" />
            <span>parzec</span>
        </a>
        
    </div>
    <div class="navitem " >
        <a class="enabled" href="https://www.npmjs.com/package/parzec" >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-npm" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M1 8h22v7h-12v2h-4v-2h-6z" />
            <path d="M7 8v7" />
            <path d="M14 8v7" />
            <path d="M17 11v4" />
            <path d="M4 11v4" />
            <path d="M11 11v1" />
            <path d="M20 11v4" />
        </svg>
            <span>Download</span>
        </a>
        
    </div>
    <div class="navitem " >
        <a class="enabled" href="https://github.com/johtela/parzec" >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
        </svg>
            <span>GitHub</span>
        </a>
        
    </div>
    <div class="navitem " >
        <a   >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-caret-down" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M6 10l6 6l6 -6h-12" />
        </svg>
            <span>Syntax Highlight</span>
        </a>
        
    <div class="navmenu toggle">
        
    <div class="navitem " id="coding-horror">
        <a   onclick="document.body.syntaxHighlight('coding-horror')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-palette" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" />
            <path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
        </svg>
            <span>Coding Horror</span>
        </a>
        
    </div>
    <div class="navitem active" id="monokai">
        <a   onclick="document.body.syntaxHighlight('monokai')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-palette" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" />
            <path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
        </svg>
            <span>Monokai</span>
        </a>
        
    </div>
    <div class="navitem " id="solarized-light">
        <a   onclick="document.body.syntaxHighlight('solarized-light')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-palette" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" />
            <path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
        </svg>
            <span>Solarized Light</span>
        </a>
        
    </div>
    <div class="navitem " id="son-of-obsidian">
        <a   onclick="document.body.syntaxHighlight('son-of-obsidian')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-palette" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" />
            <path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
        </svg>
            <span>Son of Obsidian</span>
        </a>
        
    </div>
    </div>
    </div>
    <div class="navitem " >
        <a   >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-caret-down" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M6 10l6 6l6 -6h-12" />
        </svg>
            <span>Theme</span>
        </a>
        
    <div class="navmenu toggle">
        
    <div class="navitem " id="blueberry">
        <a   onclick="document.body.theme('blueberry')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Blueberry</span>
        </a>
        
    </div>
    <div class="navitem " id="book-cover">
        <a   onclick="document.body.theme('book-cover')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Book Cover</span>
        </a>
        
    </div>
    <div class="navitem " id="brownie">
        <a   onclick="document.body.theme('brownie')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Brownie</span>
        </a>
        
    </div>
    <div class="navitem " id="chocolate">
        <a   onclick="document.body.theme('chocolate')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Chocolate</span>
        </a>
        
    </div>
    <div class="navitem " id="ice-age">
        <a   onclick="document.body.theme('ice-age')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Ice Age</span>
        </a>
        
    </div>
    <div class="navitem " id="monotone">
        <a   onclick="document.body.theme('monotone')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Monotone</span>
        </a>
        
    </div>
    <div class="navitem " id="mustard">
        <a   onclick="document.body.theme('mustard')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Mustard</span>
        </a>
        
    </div>
    <div class="navitem " id="peachy">
        <a   onclick="document.body.theme('peachy')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Peachy</span>
        </a>
        
    </div>
    <div class="navitem " id="red-alert">
        <a   onclick="document.body.theme('red-alert')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Red Alert</span>
        </a>
        
    </div>
    <div class="navitem " id="ultra-violet">
        <a   onclick="document.body.theme('ultra-violet')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Ultra Violet</span>
        </a>
        
    </div>
    <div class="navitem " id="vintage">
        <a   onclick="document.body.theme('vintage')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Vintage</span>
        </a>
        
    </div>
    </div>
    </div>
    </div>
            
    <a class="hamburger">
        <div class="bar1"></div>
        <div class="bar2"></div>
        <div class="bar3"></div>
    </a>
        </div>
        
        <div class="layout">
            <div class="sidepane narrow-scrollbars">
                
        <div class="tocmenu">
            <h3>Table of Contents</h3>
            
    <ul>
        
    <li>
        <a href="../../README.html"><span>ðŸ“”</span>Introduction</a>
    </li>
    <li>
        
    <div class="accordion">
        Examples
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-up" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M6 15l6 -6l6 6" />
        </svg>
    </div>
    
    <ul>
        
    <li>
        <a href="exprparser.html" class="highlight"><span>ðŸ“”</span>Parsing Arithmetic Epressions</a>
    </li>
    <li>
        <a href="exprtests.html"><span>ðŸ“”</span>Testing the Expression Parser</a>
    </li>
    <li>
        <a href="jsonparser.html"><span>ðŸ“”</span>Parsing JSON</a>
    </li>
    <li>
        <a href="jsontests.html"><span>ðŸ“”</span>Testing the JSON Parser</a>
    </li>
    </ul>
    </li>
    <li>
        
    <div class="accordion">
        Implementation
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-up" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M6 15l6 -6l6 6" />
        </svg>
    </div>
    
    <ul>
        
    <li>
        <a href="../index.html"><span>ðŸ“”</span>Library Structure</a>
    </li>
    <li>
        <a href="../input.html"><span>ðŸ“”</span>Parser Input</a>
    </li>
    <li>
        <a href="../result.html"><span>ðŸ“”</span>Parser Result</a>
    </li>
    <li>
        <a href="../error.html"><span>ðŸ“”</span>Error Reporting</a>
    </li>
    <li>
        <a href="../ref.html"><span>ðŸ“”</span>Reference Cells</a>
    </li>
    <li>
        <a href="../lexer.html"><span>ðŸ“”</span>Lexical Analyzer</a>
    </li>
    <li>
        <a href="../parser.html"><span>ðŸ“”</span>Parser Monad and Combinators</a>
    </li>
    <li>
        <a href="../arrayparsers.html"><span>ðŸ“”</span>Parsing Arrays and Expressions</a>
    </li>
    <li>
        <a href="../utils.html"><span>ðŸ“”</span>Utility Functions</a>
    </li>
    </ul>
    </li>
    <li>
        <a href="../../license.html"><span>ðŸ“”</span>License</a>
    </li>
    </ul>
        </div>
                <div class="toc-button"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevrons-right" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M7 7l5 5l-5 5" />
            <path d="M13 7l5 5l-5 5" />
        </svg></div>
            </div>
            
        <div class="contentarea closepopups">
            <h1 id="parsing-arithmetic-expressions">Parsing Arithmetic Expressions</h1>
<p>A common way to demonstrate parser construction is to use a grammar that
represents arithmetic expressions. We build a parser for simple expressions
that consist of addition, subtraction, multiplication, and division
operations.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="304" data-toggle="tooltip" data-title="typeof pz">pz</span> <span class="keyword">from</span> <span class="string">&quot;../&quot;</span><span class="punctuation">;</span>
</code></pre>
<h2 id="tokens">Tokens</h2>
<p>Tokens include numbers, parenthesis, operators, and whitespace.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">export</span> <span class="keyword">enum</span> <span id="324" class="typename" data-toggle="tooltip" data-title="ExprToken">ExprToken</span> <span class="punctuation">{</span> 
    <span id="448" data-toggle="tooltip" data-title="ExprToken.Number">Number</span><span class="punctuation">,</span> <span id="462" data-toggle="tooltip" data-title="ExprToken.OpenParen">OpenParen</span><span class="punctuation">,</span> <span id="473" data-toggle="tooltip" data-title="ExprToken.CloseParen">CloseParen</span><span class="punctuation">,</span> <span id="485" data-toggle="tooltip" data-title="ExprToken.Plus">Plus</span><span class="punctuation">,</span> <span id="491" data-toggle="tooltip" data-title="ExprToken.Minus">Minus</span><span class="punctuation">,</span> <span id="498" data-toggle="tooltip" data-title="ExprToken.Multiply">Multiply</span><span class="punctuation">,</span> <span id="508" data-toggle="tooltip" data-title="ExprToken.Divide">Divide</span><span class="punctuation">,</span> <span id="516" data-toggle="tooltip" data-title="ExprToken.Whitespace">Whitespace</span><span class="punctuation">,</span> 
    <span id="528" data-toggle="tooltip" data-title="ExprToken.EOF">EOF</span> 
<span class="punctuation">}</span>
</code></pre>
<p>To turn on debugging, set on the following flag. It outputs evaluated
parsing rules, which helps understanding the operation.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><a href="exprparser.html#304"><span data-toggle="tooltip" data-title="typeof pz">pz</span></a><span class="punctuation">.</span><a href="../parser.html#9606"><span data-toggle="tooltip" data-title="{ debugging: boolean; rulesEvaluated: number; errorMessages: boolean; indentation: number; indent(): void; unindent(): void; write(text: string): void; }">parserDebug</span></a><span class="punctuation">.</span><a href="../parser.html#9622"><span data-toggle="tooltip" data-title="boolean">debugging</span></a> <span class="punctuation">=</span> <span class="keyword">false</span>
</code></pre>
<h2 id="lexer">Lexer</h2>
<p>The lexer can be constructed with a single expression. We specify the
regular expression that accepts a given token, and associate it to the
member of the enumeration defined above.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">const</span> <span id="950" data-toggle="tooltip" data-title="pz.Lexer&lt;ExprToken&gt;">lexer</span> <span class="punctuation">=</span> <span class="keyword">new</span> <a href="exprparser.html#304"><span data-toggle="tooltip" data-title="typeof pz">pz</span></a><span class="punctuation">.</span><a href="../lexer.html#1693"><span class="typename" data-toggle="tooltip" data-title="typeof pz.Lexer">Lexer</span></a><span class="punctuation">&lt;</span><a href="exprparser.html#324"><span class="typename" data-toggle="tooltip" data-title="ExprToken">ExprToken</span></a><span class="punctuation">&gt;</span><span class="punctuation">(</span>
    <span class="punctuation">[</span><span class="string">/-?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/</span><span class="punctuation">,</span> <a href="exprparser.html#324"><span class="typename" data-toggle="tooltip" data-title="typeof ExprToken">ExprToken</span></a><span class="punctuation">.</span><a href="exprparser.html#448"><span data-toggle="tooltip" data-title="ExprToken.Number">Number</span></a><span class="punctuation">]</span><span class="punctuation">,</span>
    <span class="punctuation">[</span><span class="string">/\(/</span><span class="punctuation">,</span> <a href="exprparser.html#324"><span class="typename" data-toggle="tooltip" data-title="typeof ExprToken">ExprToken</span></a><span class="punctuation">.</span><a href="exprparser.html#462"><span data-toggle="tooltip" data-title="ExprToken.OpenParen">OpenParen</span></a><span class="punctuation">]</span><span class="punctuation">,</span>
    <span class="punctuation">[</span><span class="string">/\)/</span><span class="punctuation">,</span> <a href="exprparser.html#324"><span class="typename" data-toggle="tooltip" data-title="typeof ExprToken">ExprToken</span></a><span class="punctuation">.</span><a href="exprparser.html#473"><span data-toggle="tooltip" data-title="ExprToken.CloseParen">CloseParen</span></a><span class="punctuation">]</span><span class="punctuation">,</span>
    <span class="punctuation">[</span><span class="string">/\+/</span><span class="punctuation">,</span> <a href="exprparser.html#324"><span class="typename" data-toggle="tooltip" data-title="typeof ExprToken">ExprToken</span></a><span class="punctuation">.</span><a href="exprparser.html#485"><span data-toggle="tooltip" data-title="ExprToken.Plus">Plus</span></a><span class="punctuation">]</span><span class="punctuation">,</span>
    <span class="punctuation">[</span><span class="string">/-/</span><span class="punctuation">,</span> <a href="exprparser.html#324"><span class="typename" data-toggle="tooltip" data-title="typeof ExprToken">ExprToken</span></a><span class="punctuation">.</span><a href="exprparser.html#491"><span data-toggle="tooltip" data-title="ExprToken.Minus">Minus</span></a><span class="punctuation">]</span><span class="punctuation">,</span>
    <span class="punctuation">[</span><span class="string">/\*/</span><span class="punctuation">,</span> <a href="exprparser.html#324"><span class="typename" data-toggle="tooltip" data-title="typeof ExprToken">ExprToken</span></a><span class="punctuation">.</span><a href="exprparser.html#498"><span data-toggle="tooltip" data-title="ExprToken.Multiply">Multiply</span></a><span class="punctuation">]</span><span class="punctuation">,</span>
    <span class="punctuation">[</span><span class="string">/\//</span><span class="punctuation">,</span> <a href="exprparser.html#324"><span class="typename" data-toggle="tooltip" data-title="typeof ExprToken">ExprToken</span></a><span class="punctuation">.</span><a href="exprparser.html#508"><span data-toggle="tooltip" data-title="ExprToken.Divide">Divide</span></a><span class="punctuation">]</span><span class="punctuation">,</span>
    <span class="punctuation">[</span><span class="string">/[\t\n\r ]+/</span><span class="punctuation">,</span> <a href="exprparser.html#324"><span class="typename" data-toggle="tooltip" data-title="typeof ExprToken">ExprToken</span></a><span class="punctuation">.</span><a href="exprparser.html#516"><span data-toggle="tooltip" data-title="ExprToken.Whitespace">Whitespace</span></a><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre>
<h2 id="parser">Parser</h2>
<p>Parser is built from two kinds of parsing rules: ones that recognize
<em>terminals</em> and others that recognize <em>nonterminals</em>.</p>
<h3 id="terminals">Terminals</h3>
<p>Terminal parsers recognize the tokens returned by the lexer. They are
straightforward to define.</p>
<p>First we define a parser that skips any whitespace between the tokens.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">const</span> <span id="1661" data-toggle="tooltip" data-title="pz.Parser&lt;pz.Token&lt;ExprToken&gt; | null, pz.Token&lt;ExprToken&gt;&gt;">optws</span> <span class="punctuation">=</span> <a href="exprparser.html#304"><span data-toggle="tooltip" data-title="typeof pz">pz</span></a><span class="punctuation">.</span><a href="../parser.html#17684"><span class="member" data-toggle="tooltip" data-title="&lt;T&gt;(tok: T, name: string) =&gt; pz.Parser&lt;pz.Token&lt;T&gt;, pz.Token&lt;T&gt;&gt;">terminal</span></a><span class="punctuation">(</span><a href="exprparser.html#324"><span class="typename" data-toggle="tooltip" data-title="typeof ExprToken">ExprToken</span></a><span class="punctuation">.</span><a href="exprparser.html#516"><span data-toggle="tooltip" data-title="ExprToken.Whitespace">Whitespace</span></a><span class="punctuation">,</span> <span class="string">&quot;&lt;whitespace&gt;&quot;</span><span class="punctuation">)</span><span class="punctuation">.</span><a href="../parser.html#3655"><span class="member" data-toggle="tooltip" data-title="() =&gt; pz.Parser&lt;pz.Token&lt;ExprToken&gt; | null, pz.Token&lt;ExprToken&gt;&gt;">optionalRef</span></a><span class="punctuation">(</span><span class="punctuation">)</span>
</code></pre>
<p>Next we define parser for numbers. We convert the recognized text to <code>number</code>
type. We skip the trailing whitespace with the <code>followedBy</code> combinator.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">const</span> <span id="1908" data-toggle="tooltip" data-title="pz.Parser&lt;number, pz.Token&lt;ExprToken&gt;&gt;">number</span> <span class="punctuation">=</span> <a href="exprparser.html#304"><span data-toggle="tooltip" data-title="typeof pz">pz</span></a><span class="punctuation">.</span><a href="../parser.html#17684"><span class="member" data-toggle="tooltip" data-title="&lt;T&gt;(tok: T, name: string) =&gt; pz.Parser&lt;pz.Token&lt;T&gt;, pz.Token&lt;T&gt;&gt;">terminal</span></a><span class="punctuation">(</span><a href="exprparser.html#324"><span class="typename" data-toggle="tooltip" data-title="typeof ExprToken">ExprToken</span></a><span class="punctuation">.</span><a href="exprparser.html#448"><span data-toggle="tooltip" data-title="ExprToken.Number">Number</span></a><span class="punctuation">,</span> <span class="string">&quot;&lt;number&gt;&quot;</span><span class="punctuation">)</span>
    <span class="punctuation">.</span><a href="../parser.html#2286"><span class="member" data-toggle="tooltip" data-title="&lt;U&gt;(mapper: (value: pz.Token&lt;ExprToken&gt;) =&gt; U) =&gt; pz.Parser&lt;U, pz.Token&lt;ExprToken&gt;&gt;">map</span></a><span class="punctuation">(</span><span id="1970" data-toggle="tooltip" data-title="pz.Token&lt;ExprToken&gt;">t</span> <span class="punctuation">=&gt;</span> <span class="typename" data-toggle="tooltip" data-title="NumberConstructor">Number</span><span class="punctuation">(</span><a href="exprparser.html#1970"><span data-toggle="tooltip" data-title="pz.Token&lt;ExprToken&gt;">t</span></a><span class="punctuation">.</span><a href="../lexer.html#1456"><span data-toggle="tooltip" data-title="string">text</span></a><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">.</span><a href="../arrayparsers.html#775"><span class="member" data-toggle="tooltip" data-title="&lt;U&gt;(after: pz.Parser&lt;U, pz.Token&lt;ExprToken&gt;&gt;) =&gt; pz.Parser&lt;number, pz.Token&lt;ExprToken&gt;&gt;">followedBy</span></a><span class="punctuation">(</span><a href="exprparser.html#1661"><span data-toggle="tooltip" data-title="pz.Parser&lt;pz.Token&lt;ExprToken&gt; | null, pz.Token&lt;ExprToken&gt;&gt;">optws</span></a><span class="punctuation">)</span>
</code></pre>
<p>Parenthesis and operators are all recognized the same way. Again, we skip the
trailing whitespace to keep the other rules simple.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">const</span> <span id="2163" data-toggle="tooltip" data-title="pz.Parser&lt;pz.Token&lt;ExprToken&gt;, pz.Token&lt;ExprToken&gt;&gt;">openParen</span> <span class="punctuation">=</span> <a href="exprparser.html#304"><span data-toggle="tooltip" data-title="typeof pz">pz</span></a><span class="punctuation">.</span><a href="../parser.html#17684"><span class="member" data-toggle="tooltip" data-title="&lt;T&gt;(tok: T, name: string) =&gt; pz.Parser&lt;pz.Token&lt;T&gt;, pz.Token&lt;T&gt;&gt;">terminal</span></a><span class="punctuation">(</span><a href="exprparser.html#324"><span class="typename" data-toggle="tooltip" data-title="typeof ExprToken">ExprToken</span></a><span class="punctuation">.</span><a href="exprparser.html#462"><span data-toggle="tooltip" data-title="ExprToken.OpenParen">OpenParen</span></a><span class="punctuation">,</span> <span class="string">&quot;(&quot;</span><span class="punctuation">)</span><span class="punctuation">.</span><a href="../arrayparsers.html#775"><span class="member" data-toggle="tooltip" data-title="&lt;U&gt;(after: pz.Parser&lt;U, pz.Token&lt;ExprToken&gt;&gt;) =&gt; pz.Parser&lt;pz.Token&lt;ExprToken&gt;, pz.Token&lt;ExprToken&gt;&gt;">followedBy</span></a><span class="punctuation">(</span><a href="exprparser.html#1661"><span data-toggle="tooltip" data-title="pz.Parser&lt;pz.Token&lt;ExprToken&gt; | null, pz.Token&lt;ExprToken&gt;&gt;">optws</span></a><span class="punctuation">)</span>
<span class="keyword">const</span> <span id="2238" data-toggle="tooltip" data-title="pz.Parser&lt;pz.Token&lt;ExprToken&gt;, pz.Token&lt;ExprToken&gt;&gt;">closeParen</span> <span class="punctuation">=</span> <a href="exprparser.html#304"><span data-toggle="tooltip" data-title="typeof pz">pz</span></a><span class="punctuation">.</span><a href="../parser.html#17684"><span class="member" data-toggle="tooltip" data-title="&lt;T&gt;(tok: T, name: string) =&gt; pz.Parser&lt;pz.Token&lt;T&gt;, pz.Token&lt;T&gt;&gt;">terminal</span></a><span class="punctuation">(</span><a href="exprparser.html#324"><span class="typename" data-toggle="tooltip" data-title="typeof ExprToken">ExprToken</span></a><span class="punctuation">.</span><a href="exprparser.html#473"><span data-toggle="tooltip" data-title="ExprToken.CloseParen">CloseParen</span></a><span class="punctuation">,</span> <span class="string">&quot;)&quot;</span><span class="punctuation">)</span><span class="punctuation">.</span><a href="../arrayparsers.html#775"><span class="member" data-toggle="tooltip" data-title="&lt;U&gt;(after: pz.Parser&lt;U, pz.Token&lt;ExprToken&gt;&gt;) =&gt; pz.Parser&lt;pz.Token&lt;ExprToken&gt;, pz.Token&lt;ExprToken&gt;&gt;">followedBy</span></a><span class="punctuation">(</span><a href="exprparser.html#1661"><span data-toggle="tooltip" data-title="pz.Parser&lt;pz.Token&lt;ExprToken&gt; | null, pz.Token&lt;ExprToken&gt;&gt;">optws</span></a><span class="punctuation">)</span>
<span class="keyword">const</span> <span id="2315" data-toggle="tooltip" data-title="pz.Parser&lt;pz.Token&lt;ExprToken&gt;, pz.Token&lt;ExprToken&gt;&gt;">plus</span> <span class="punctuation">=</span> <a href="exprparser.html#304"><span data-toggle="tooltip" data-title="typeof pz">pz</span></a><span class="punctuation">.</span><a href="../parser.html#17684"><span class="member" data-toggle="tooltip" data-title="&lt;T&gt;(tok: T, name: string) =&gt; pz.Parser&lt;pz.Token&lt;T&gt;, pz.Token&lt;T&gt;&gt;">terminal</span></a><span class="punctuation">(</span><a href="exprparser.html#324"><span class="typename" data-toggle="tooltip" data-title="typeof ExprToken">ExprToken</span></a><span class="punctuation">.</span><a href="exprparser.html#485"><span data-toggle="tooltip" data-title="ExprToken.Plus">Plus</span></a><span class="punctuation">,</span> <span class="string">&quot;+&quot;</span><span class="punctuation">)</span><span class="punctuation">.</span><a href="../arrayparsers.html#775"><span class="member" data-toggle="tooltip" data-title="&lt;U&gt;(after: pz.Parser&lt;U, pz.Token&lt;ExprToken&gt;&gt;) =&gt; pz.Parser&lt;pz.Token&lt;ExprToken&gt;, pz.Token&lt;ExprToken&gt;&gt;">followedBy</span></a><span class="punctuation">(</span><a href="exprparser.html#1661"><span data-toggle="tooltip" data-title="pz.Parser&lt;pz.Token&lt;ExprToken&gt; | null, pz.Token&lt;ExprToken&gt;&gt;">optws</span></a><span class="punctuation">)</span>
<span class="keyword">const</span> <span id="2380" data-toggle="tooltip" data-title="pz.Parser&lt;pz.Token&lt;ExprToken&gt;, pz.Token&lt;ExprToken&gt;&gt;">minus</span> <span class="punctuation">=</span> <a href="exprparser.html#304"><span data-toggle="tooltip" data-title="typeof pz">pz</span></a><span class="punctuation">.</span><a href="../parser.html#17684"><span class="member" data-toggle="tooltip" data-title="&lt;T&gt;(tok: T, name: string) =&gt; pz.Parser&lt;pz.Token&lt;T&gt;, pz.Token&lt;T&gt;&gt;">terminal</span></a><span class="punctuation">(</span><a href="exprparser.html#324"><span class="typename" data-toggle="tooltip" data-title="typeof ExprToken">ExprToken</span></a><span class="punctuation">.</span><a href="exprparser.html#491"><span data-toggle="tooltip" data-title="ExprToken.Minus">Minus</span></a><span class="punctuation">,</span> <span class="string">&quot;-&quot;</span><span class="punctuation">)</span><span class="punctuation">.</span><a href="../arrayparsers.html#775"><span class="member" data-toggle="tooltip" data-title="&lt;U&gt;(after: pz.Parser&lt;U, pz.Token&lt;ExprToken&gt;&gt;) =&gt; pz.Parser&lt;pz.Token&lt;ExprToken&gt;, pz.Token&lt;ExprToken&gt;&gt;">followedBy</span></a><span class="punctuation">(</span><a href="exprparser.html#1661"><span data-toggle="tooltip" data-title="pz.Parser&lt;pz.Token&lt;ExprToken&gt; | null, pz.Token&lt;ExprToken&gt;&gt;">optws</span></a><span class="punctuation">)</span>
<span class="keyword">const</span> <span id="2447" data-toggle="tooltip" data-title="pz.Parser&lt;pz.Token&lt;ExprToken&gt;, pz.Token&lt;ExprToken&gt;&gt;">multiply</span> <span class="punctuation">=</span> <a href="exprparser.html#304"><span data-toggle="tooltip" data-title="typeof pz">pz</span></a><span class="punctuation">.</span><a href="../parser.html#17684"><span class="member" data-toggle="tooltip" data-title="&lt;T&gt;(tok: T, name: string) =&gt; pz.Parser&lt;pz.Token&lt;T&gt;, pz.Token&lt;T&gt;&gt;">terminal</span></a><span class="punctuation">(</span><a href="exprparser.html#324"><span class="typename" data-toggle="tooltip" data-title="typeof ExprToken">ExprToken</span></a><span class="punctuation">.</span><a href="exprparser.html#498"><span data-toggle="tooltip" data-title="ExprToken.Multiply">Multiply</span></a><span class="punctuation">,</span> <span class="string">&quot;*&quot;</span><span class="punctuation">)</span><span class="punctuation">.</span><a href="../arrayparsers.html#775"><span class="member" data-toggle="tooltip" data-title="&lt;U&gt;(after: pz.Parser&lt;U, pz.Token&lt;ExprToken&gt;&gt;) =&gt; pz.Parser&lt;pz.Token&lt;ExprToken&gt;, pz.Token&lt;ExprToken&gt;&gt;">followedBy</span></a><span class="punctuation">(</span><a href="exprparser.html#1661"><span data-toggle="tooltip" data-title="pz.Parser&lt;pz.Token&lt;ExprToken&gt; | null, pz.Token&lt;ExprToken&gt;&gt;">optws</span></a><span class="punctuation">)</span>
<span class="keyword">const</span> <span id="2520" data-toggle="tooltip" data-title="pz.Parser&lt;pz.Token&lt;ExprToken&gt;, pz.Token&lt;ExprToken&gt;&gt;">divide</span> <span class="punctuation">=</span> <a href="exprparser.html#304"><span data-toggle="tooltip" data-title="typeof pz">pz</span></a><span class="punctuation">.</span><a href="../parser.html#17684"><span class="member" data-toggle="tooltip" data-title="&lt;T&gt;(tok: T, name: string) =&gt; pz.Parser&lt;pz.Token&lt;T&gt;, pz.Token&lt;T&gt;&gt;">terminal</span></a><span class="punctuation">(</span><a href="exprparser.html#324"><span class="typename" data-toggle="tooltip" data-title="typeof ExprToken">ExprToken</span></a><span class="punctuation">.</span><a href="exprparser.html#508"><span data-toggle="tooltip" data-title="ExprToken.Divide">Divide</span></a><span class="punctuation">,</span> <span class="string">&quot;/&quot;</span><span class="punctuation">)</span><span class="punctuation">.</span><a href="../arrayparsers.html#775"><span class="member" data-toggle="tooltip" data-title="&lt;U&gt;(after: pz.Parser&lt;U, pz.Token&lt;ExprToken&gt;&gt;) =&gt; pz.Parser&lt;pz.Token&lt;ExprToken&gt;, pz.Token&lt;ExprToken&gt;&gt;">followedBy</span></a><span class="punctuation">(</span><a href="exprparser.html#1661"><span data-toggle="tooltip" data-title="pz.Parser&lt;pz.Token&lt;ExprToken&gt; | null, pz.Token&lt;ExprToken&gt;&gt;">optws</span></a><span class="punctuation">)</span>
</code></pre>
<p><code>eof</code> is a special terminal parser that recognizes end of input.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">const</span> <span id="2668" data-toggle="tooltip" data-title="pz.Parser&lt;pz.Token&lt;ExprToken&gt;, pz.Token&lt;ExprToken&gt;&gt;">eof</span> <span class="punctuation">=</span> <a href="exprparser.html#304"><span data-toggle="tooltip" data-title="typeof pz">pz</span></a><span class="punctuation">.</span><a href="../parser.html#17684"><span class="member" data-toggle="tooltip" data-title="&lt;T&gt;(tok: T, name: string) =&gt; pz.Parser&lt;pz.Token&lt;T&gt;, pz.Token&lt;T&gt;&gt;">terminal</span></a><span class="punctuation">(</span><a href="exprparser.html#324"><span class="typename" data-toggle="tooltip" data-title="typeof ExprToken">ExprToken</span></a><span class="punctuation">.</span><a href="exprparser.html#528"><span data-toggle="tooltip" data-title="ExprToken.EOF">EOF</span></a><span class="punctuation">,</span> <span class="string">&quot;&lt;end of input&gt;&quot;</span><span class="punctuation">)</span>
</code></pre>
<h3 id="nonterminals">Nonterminals</h3>
<p>The abstract nodes in a syntax tree are called nonterminals. We define a
parser for each nonterminal. Since expressions can theoretically be
infinitely long, the parsers are recursive.</p>
<p>First we define parsers for operators. We utilize the <code>operators</code> combinator
which is designed just for this purpose. These parsers calculate the result
of the operation, and return it to the parent parser.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">const</span> <span id="3185" data-toggle="tooltip" data-title="pz.Parser&lt;(a: number, b: number) =&gt; number, pz.Token&lt;ExprToken&gt;&gt;">addop</span> <span class="punctuation">=</span> <a href="exprparser.html#304"><span data-toggle="tooltip" data-title="typeof pz">pz</span></a><span class="punctuation">.</span><a href="../arrayparsers.html#4603"><span class="member" data-toggle="tooltip" data-title="&lt;T, U, S&gt;(...ops: [pz.Parser&lt;T, S&gt;, U][]) =&gt; pz.Parser&lt;U, S&gt;">operators</span></a><span class="punctuation">(</span>
    <span class="punctuation">[</span><a href="exprparser.html#2315"><span data-toggle="tooltip" data-title="pz.Parser&lt;pz.Token&lt;ExprToken&gt;, pz.Token&lt;ExprToken&gt;&gt;">plus</span></a><span class="punctuation">,</span> <span class="punctuation">(</span><span id="3221" data-toggle="tooltip" data-title="number">a</span><span class="punctuation">:</span> <span class="keyword">number</span><span class="punctuation">,</span> <span id="3231" data-toggle="tooltip" data-title="number">b</span><span class="punctuation">:</span> <span class="keyword">number</span><span class="punctuation">)</span> <span class="punctuation">=&gt;</span> <a href="exprparser.html#3221"><span data-toggle="tooltip" data-title="number">a</span></a> <span class="punctuation">+</span> <a href="exprparser.html#3231"><span data-toggle="tooltip" data-title="number">b</span></a><span class="punctuation">]</span><span class="punctuation">,</span>
    <span class="punctuation">[</span><a href="exprparser.html#2380"><span data-toggle="tooltip" data-title="pz.Parser&lt;pz.Token&lt;ExprToken&gt;, pz.Token&lt;ExprToken&gt;&gt;">minus</span></a><span class="punctuation">,</span> <span class="punctuation">(</span><span id="3268" data-toggle="tooltip" data-title="number">a</span><span class="punctuation">:</span> <span class="keyword">number</span><span class="punctuation">,</span> <span id="3278" data-toggle="tooltip" data-title="number">b</span><span class="punctuation">:</span> <span class="keyword">number</span><span class="punctuation">)</span> <span class="punctuation">=&gt;</span> <a href="exprparser.html#3268"><span data-toggle="tooltip" data-title="number">a</span></a> <span class="punctuation">-</span> <a href="exprparser.html#3278"><span data-toggle="tooltip" data-title="number">b</span></a><span class="punctuation">]</span><span class="punctuation">)</span>
<span class="keyword">const</span> <span id="3307" data-toggle="tooltip" data-title="pz.Parser&lt;(a: number, b: number) =&gt; number, pz.Token&lt;ExprToken&gt;&gt;">mulop</span> <span class="punctuation">=</span> <a href="exprparser.html#304"><span data-toggle="tooltip" data-title="typeof pz">pz</span></a><span class="punctuation">.</span><a href="../arrayparsers.html#4603"><span class="member" data-toggle="tooltip" data-title="&lt;T, U, S&gt;(...ops: [pz.Parser&lt;T, S&gt;, U][]) =&gt; pz.Parser&lt;U, S&gt;">operators</span></a><span class="punctuation">(</span>
    <span class="punctuation">[</span><a href="exprparser.html#2447"><span data-toggle="tooltip" data-title="pz.Parser&lt;pz.Token&lt;ExprToken&gt;, pz.Token&lt;ExprToken&gt;&gt;">multiply</span></a><span class="punctuation">,</span> <span class="punctuation">(</span><span id="3347" data-toggle="tooltip" data-title="number">a</span><span class="punctuation">:</span> <span class="keyword">number</span><span class="punctuation">,</span> <span id="3357" data-toggle="tooltip" data-title="number">b</span><span class="punctuation">:</span> <span class="keyword">number</span><span class="punctuation">)</span> <span class="punctuation">=&gt;</span> <a href="exprparser.html#3347"><span data-toggle="tooltip" data-title="number">a</span></a> <span class="punctuation">*</span> <a href="exprparser.html#3357"><span data-toggle="tooltip" data-title="number">b</span></a><span class="punctuation">]</span><span class="punctuation">,</span>
    <span class="punctuation">[</span><a href="exprparser.html#2520"><span data-toggle="tooltip" data-title="pz.Parser&lt;pz.Token&lt;ExprToken&gt;, pz.Token&lt;ExprToken&gt;&gt;">divide</span></a><span class="punctuation">,</span> <span class="punctuation">(</span><span id="3395" data-toggle="tooltip" data-title="number">a</span><span class="punctuation">:</span> <span class="keyword">number</span><span class="punctuation">,</span> <span id="3405" data-toggle="tooltip" data-title="number">b</span><span class="punctuation">:</span> <span class="keyword">number</span><span class="punctuation">)</span> <span class="punctuation">=&gt;</span> <a href="exprparser.html#3395"><span data-toggle="tooltip" data-title="number">a</span></a> <span class="punctuation">/</span> <a href="exprparser.html#3405"><span data-toggle="tooltip" data-title="number">b</span></a><span class="punctuation">]</span><span class="punctuation">)</span>
</code></pre>
<p>Terms are the results of multiplication or division operators. We define
the term parser as a reference as we need the factor parser in its
definition.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">const</span> <span id="3609" data-toggle="tooltip" data-title="pz.Ref&lt;pz.Parser&lt;number, pz.Token&lt;ExprToken&gt;&gt;&gt;">term</span> <span class="punctuation">=</span> <span class="keyword">new</span> <a href="exprparser.html#304"><span data-toggle="tooltip" data-title="typeof pz">pz</span></a><span class="punctuation">.</span><a href="../ref.html#0"><span class="typename" data-toggle="tooltip" data-title="typeof pz.Ref">Ref</span></a><span class="punctuation">&lt;</span><a href="exprparser.html#304"><span data-toggle="tooltip" data-title="any">pz</span></a><span class="punctuation">.</span><a href="../parser.html#870"><span class="typename" data-toggle="tooltip" data-title="pz.Parser&lt;T, S&gt;">Parser</span></a><span class="punctuation">&lt;</span><span class="keyword">number</span><span class="punctuation">,</span> <a href="exprparser.html#304"><span data-toggle="tooltip" data-title="any">pz</span></a><span class="punctuation">.</span><a href="../lexer.html#1200"><span class="typename" data-toggle="tooltip" data-title="pz.Token&lt;S&gt;">Token</span></a><span class="punctuation">&lt;</span><a href="exprparser.html#324"><span class="typename" data-toggle="tooltip" data-title="ExprToken">ExprToken</span></a><span class="punctuation">&gt;</span><span class="punctuation">&gt;</span><span class="punctuation">&gt;</span><span class="punctuation">(</span><span class="punctuation">)</span>
</code></pre>
<p>Expressions consist of terms that are added or subtracted together. Note how
the grammar implicitly defines the precedence order as terms are recognized
before the expressions.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">const</span> <span id="3876" data-toggle="tooltip" data-title="pz.Parser&lt;number, pz.Token&lt;ExprToken&gt;&gt;">expr</span> <span class="punctuation">=</span> <a href="exprparser.html#304"><span data-toggle="tooltip" data-title="typeof pz">pz</span></a><span class="punctuation">.</span><a href="../parser.html#16514"><span class="member" data-toggle="tooltip" data-title="&lt;T, S&gt;(parser: pz.Ref&lt;pz.Parser&lt;T, S&gt;&gt;) =&gt; pz.Parser&lt;T, S&gt;">forwardRef</span></a><span class="punctuation">(</span><a href="exprparser.html#3609"><span data-toggle="tooltip" data-title="pz.Ref&lt;pz.Parser&lt;number, pz.Token&lt;ExprToken&gt;&gt;&gt;">term</span></a><span class="punctuation">)</span><span class="punctuation">.</span><a href="../arrayparsers.html#978"><span class="member" data-toggle="tooltip" data-title="(operation: pz.Parser&lt;pz.BinaryOp&lt;number&gt;, pz.Token&lt;ExprToken&gt;&gt;) =&gt; pz.Parser&lt;number, pz.Token&lt;ExprToken&gt;&gt;">chainOneOrMore</span></a><span class="punctuation">(</span><a href="exprparser.html#3185"><span data-toggle="tooltip" data-title="pz.Parser&lt;(a: number, b: number) =&gt; number, pz.Token&lt;ExprToken&gt;&gt;">addop</span></a><span class="punctuation">)</span>
</code></pre>
<p>To change the precedence order we uses parenthesis as usual. When an
expression is surrounded by parentehesis it becomes a factor which is
recognized before terms. So, a factor is either a number or an expression
in parenthesis.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">const</span> <span id="4188" data-toggle="tooltip" data-title="pz.Parser&lt;number, pz.Token&lt;ExprToken&gt;&gt;">factor</span> <span class="punctuation">=</span> <a href="exprparser.html#3876"><span data-toggle="tooltip" data-title="pz.Parser&lt;number, pz.Token&lt;ExprToken&gt;&gt;">expr</span></a><span class="punctuation">.</span><a href="../arrayparsers.html#896"><span class="member" data-toggle="tooltip" data-title="&lt;U, V&gt;(open: pz.Parser&lt;U, pz.Token&lt;ExprToken&gt;&gt;, close: pz.Parser&lt;V, pz.Token&lt;ExprToken&gt;&gt;) =&gt; pz.Parser&lt;number, pz.Token&lt;ExprToken&gt;&gt;">bracketedBy</span></a><span class="punctuation">(</span><a href="exprparser.html#2163"><span data-toggle="tooltip" data-title="pz.Parser&lt;pz.Token&lt;ExprToken&gt;, pz.Token&lt;ExprToken&gt;&gt;">openParen</span></a><span class="punctuation">,</span> <a href="exprparser.html#2238"><span data-toggle="tooltip" data-title="pz.Parser&lt;pz.Token&lt;ExprToken&gt;, pz.Token&lt;ExprToken&gt;&gt;">closeParen</span></a><span class="punctuation">)</span><span class="punctuation">.</span><a href="../parser.html#2607"><span class="member" data-toggle="tooltip" data-title="&lt;U&gt;(other: pz.Parser&lt;U, pz.Token&lt;ExprToken&gt;&gt;) =&gt; pz.Parser&lt;number | U, pz.Token&lt;ExprToken&gt;&gt;">or</span></a><span class="punctuation">(</span><a href="exprparser.html#1908"><span data-toggle="tooltip" data-title="pz.Parser&lt;number, pz.Token&lt;ExprToken&gt;&gt;">number</span></a><span class="punctuation">)</span>
</code></pre>
<p>Now we can define the term as sequence of factors separated by multiplication
or division operators.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><a href="exprparser.html#3609"><span data-toggle="tooltip" data-title="pz.Ref&lt;pz.Parser&lt;number, pz.Token&lt;ExprToken&gt;&gt;&gt;">term</span></a><span class="punctuation">.</span><a href="../ref.html#750"><span class="member" data-toggle="tooltip" data-title="pz.Parser&lt;number, pz.Token&lt;ExprToken&gt;&gt;">target</span></a> <span class="punctuation">=</span> <a href="exprparser.html#4188"><span data-toggle="tooltip" data-title="pz.Parser&lt;number, pz.Token&lt;ExprToken&gt;&gt;">factor</span></a><span class="punctuation">.</span><a href="../arrayparsers.html#978"><span class="member" data-toggle="tooltip" data-title="(operation: pz.Parser&lt;pz.BinaryOp&lt;number&gt;, pz.Token&lt;ExprToken&gt;&gt;) =&gt; pz.Parser&lt;number, pz.Token&lt;ExprToken&gt;&gt;">chainOneOrMore</span></a><span class="punctuation">(</span><a href="exprparser.html#3307"><span data-toggle="tooltip" data-title="pz.Parser&lt;(a: number, b: number) =&gt; number, pz.Token&lt;ExprToken&gt;&gt;">mulop</span></a><span class="punctuation">)</span>
</code></pre>
<p>Last we define the root parser, which just skips any leading whitespace
before calling the expression parser. Whitespace in-between tokens is
skipped by terminal parsers.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">const</span> <span id="4612" data-toggle="tooltip" data-title="pz.Parser&lt;number, pz.Token&lt;ExprToken&gt;&gt;">rootExpr</span> <span class="punctuation">=</span> <a href="exprparser.html#1661"><span data-toggle="tooltip" data-title="pz.Parser&lt;pz.Token&lt;ExprToken&gt; | null, pz.Token&lt;ExprToken&gt;&gt;">optws</span></a><span class="punctuation">.</span><a href="../parser.html#2035"><span class="member" data-toggle="tooltip" data-title="&lt;U&gt;(other: pz.Parser&lt;U, pz.Token&lt;ExprToken&gt;&gt;) =&gt; pz.Parser&lt;U, pz.Token&lt;ExprToken&gt;&gt;">seq</span></a><span class="punctuation">(</span><a href="exprparser.html#3876"><span data-toggle="tooltip" data-title="pz.Parser&lt;number, pz.Token&lt;ExprToken&gt;&gt;">expr</span></a><span class="punctuation">)</span><span class="punctuation">.</span><a href="../arrayparsers.html#775"><span class="member" data-toggle="tooltip" data-title="&lt;U&gt;(after: pz.Parser&lt;U, pz.Token&lt;ExprToken&gt;&gt;) =&gt; pz.Parser&lt;number, pz.Token&lt;ExprToken&gt;&gt;">followedBy</span></a><span class="punctuation">(</span><a href="exprparser.html#2668"><span data-toggle="tooltip" data-title="pz.Parser&lt;pz.Token&lt;ExprToken&gt;, pz.Token&lt;ExprToken&gt;&gt;">eof</span></a><span class="punctuation">)</span>
</code></pre>
<h2 id="exported-parsing-function">Exported Parsing Function</h2>
<p>Now we can define the helper functions which parses an expression string and
calculates its value. To get a <code>ParserInput&lt;ExprToken&gt;</code> interface required
by the parser, we call the <code>lexerInput</code> function, which takes the lexer and
input expression as arguments.</p>
<p>After that we can call the <code>parse</code> function which takes the root grammar
rule and the input as parameters.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">export</span> <span class="keyword">function</span> <span id="4655" class="member" data-toggle="tooltip" data-title="(expression: string) =&gt; number">evaluateExpression</span><span class="punctuation">(</span><span id="5138" data-toggle="tooltip" data-title="string">expression</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="keyword">number</span> <span class="punctuation">{</span>
    <span class="keyword">return</span> <a href="exprparser.html#304"><span data-toggle="tooltip" data-title="typeof pz">pz</span></a><span class="punctuation">.</span><a href="../parser.html#11096"><span class="member" data-toggle="tooltip" data-title="&lt;T, S&gt;(parser: pz.Parser&lt;T, S&gt;, input: pz.ParserInput&lt;S&gt;) =&gt; T">parse</span></a><span class="punctuation">(</span><a href="exprparser.html#4612"><span data-toggle="tooltip" data-title="pz.Parser&lt;number, pz.Token&lt;ExprToken&gt;&gt;">rootExpr</span></a><span class="punctuation">,</span> <a href="exprparser.html#304"><span data-toggle="tooltip" data-title="typeof pz">pz</span></a><span class="punctuation">.</span><a href="../lexer.html#5367"><span class="member" data-toggle="tooltip" data-title="&lt;S&gt;(text: string, lexer: pz.Lexer&lt;S&gt;, eof: pz.Token&lt;S&gt;) =&gt; pz.ParserInput&lt;pz.Token&lt;S&gt;&gt;">lexerInput</span></a><span class="punctuation">&lt;</span><a href="exprparser.html#324"><span class="typename" data-toggle="tooltip" data-title="ExprToken">ExprToken</span></a><span class="punctuation">&gt;</span><span class="punctuation">(</span><a href="exprparser.html#5138"><span data-toggle="tooltip" data-title="string">expression</span></a><span class="punctuation">,</span> <a href="exprparser.html#950"><span data-toggle="tooltip" data-title="pz.Lexer&lt;ExprToken&gt;">lexer</span></a><span class="punctuation">,</span> 
        <span class="keyword">new</span> <a href="exprparser.html#304"><span data-toggle="tooltip" data-title="typeof pz">pz</span></a><span class="punctuation">.</span><a href="../lexer.html#1200"><span class="typename" data-toggle="tooltip" data-title="typeof pz.Token">Token</span></a><span class="punctuation">(</span><a href="exprparser.html#324"><span class="typename" data-toggle="tooltip" data-title="typeof ExprToken">ExprToken</span></a><span class="punctuation">.</span><a href="exprparser.html#528"><span data-toggle="tooltip" data-title="ExprToken.EOF">EOF</span></a><span class="punctuation">,</span> <span class="string">&quot;&lt;end of input&gt;&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>

        </div>
            <div class="sidepane narrow-scrollbars">
                
        <div class="pagemenu">
            <h3>On This Page</h3>
                <ul class="pagetree">
                </ul>
        </div>
            </div>
        </div>
        
        <div class="footer">
            <a class="footer-button" href="../../README.html">
            <p>Previous</p>
            <p>Â« Introduction</p>
        </a>
            <div class="footer-text">
                <p>Copyright Â© 2020 Tommi Johtela</p>
                <p>Generated by 
                    <a href="https://johtela.github.io/litscript">LiTScript</a>
                </p>
            </div>
            <a class="footer-button" href="exprtests.html">
            <p>Next</p>
            <p>Testing the Expression Parser Â»</p>
        </a>
        </div>
    
        <script src="../../dist/normal.js"></script>
    </body>
    </html>